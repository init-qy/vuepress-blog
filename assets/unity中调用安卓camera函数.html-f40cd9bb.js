import{_ as t,r as o,o as c,c as p,a as n,b as a,d as e,e as i}from"./app-46d51712.js";const l={},r=i(`<p><code>Unity</code> itself provides interfaces such as <code>WebcamDevice</code> and <code>WebcamTexture</code> to support access to physical cameras. However, these interfaces provide limited parameters, so we need to call native functions in <code>Unity</code> to obtain the corresponding parameters.</p><h2 id="environment" tabindex="-1"><a class="header-anchor" href="#environment" aria-hidden="true">#</a> Environment</h2><p>Since <code>Android</code> or <code>Unity</code> versions change rapidly, here is the current environment:</p><ul><li>Unity 2021.3.19f1</li><li>Android 12.0 API31 emulator</li></ul><h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h2><p>The following code is an example of using the <code>CameraCharacteristics</code> class in Android to obtain the available <code>focal_length</code> and <code>sensor_info_physical_size</code>.</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> player <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AndroidJavaClass</span><span class="token punctuation">(</span><span class="token string">&quot;com.unity3d.player.UnityPlayer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> activity <span class="token operator">=</span> player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetStatic</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;currentActivity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> cameraManager <span class="token operator">=</span> activity<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Call</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;getSystemService&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;camera&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>cameraManager <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> CameraCharacteristics <span class="token operator">=</span> cameraManager<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Call</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;getCameraCharacteristics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// device id</span>

    <span class="token class-name">AndroidJavaObject</span> key_focal_lens <span class="token operator">=</span> CameraCharacteristics<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetStatic</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;LENS_INFO_AVAILABLE_FOCAL_LENGTHS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AndroidJavaObject</span> key_sensor_size <span class="token operator">=</span> CameraCharacteristics<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetStatic</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;SENSOR_INFO_PHYSICAL_SIZE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> focal_lens <span class="token operator">=</span> CameraCharacteristics<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Call</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> key_focal_lens<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AndroidJavaObject</span> sensor_size <span class="token operator">=</span> CameraCharacteristics<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Call</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AndroidJavaObject<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> key_sensor_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">float</span></span> sensor_width <span class="token operator">=</span> sensor_size<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Call</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;getWidth&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><p>In the code above, if you are calling a method in a class, use <code>Call</code>, where the first parameter is the method name and the second parameter is optional, representing the arguments passed.<br> If the original class is needed during the argument passing process, such as the <code>Key</code> in the code above, it needs to be wrapped with <code>AndroidJavaObject</code>. Only some basic types (<code>int</code>, <code>float[]</code>) can be passed directly.<br> If you are accessing a member (fields) in a class, use <code>GetStatic</code>. For example, <code>CameraCharacteristics.LENS_INFO_AVAILABLE_FOCAL_LENGTHS</code> in Java can be obtained using <code>GetStatic</code>.</p><h2 id="references" tabindex="-1"><a class="header-anchor" href="#references" aria-hidden="true">#</a> References</h2>`,10),u={href:"https://github.com/ricoh-live-streaming-api/android-sdk-samples/blob/main/unity-samples/unity-app/Assets/Scripts/CameraInfoList.cs",target:"_blank",rel:"noopener noreferrer"},d={href:"https://github.com/huailiang/WebCam",target:"_blank",rel:"noopener noreferrer"},k={href:"https://developer.android.com/reference/android/hardware/camera2/package-summary.html",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new",target:"_blank",rel:"noopener noreferrer"},h=n("strong",null,"feedback",-1);function g(v,_){const s=o("ExternalLinkIcon");return c(),p("div",null,[r,n("ul",null,[n("li",null,[n("a",u,[a("https://github.com/ricoh-live-streaming-api/android-sdk-samples/blob/main/unity-samples/unity-app/Assets/Scripts/CameraInfoList.cs"),e(s)])]),n("li",null,[n("a",d,[a("https://github.com/huailiang/WebCam"),e(s)])]),n("li",null,[n("a",k,[a("https://developer.android.com/reference/android/hardware/camera2/package-summary.html"),e(s)])])]),n("blockquote",null,[n("p",null,[a("This post is translated using ChatGPT, please "),n("a",m,[h,e(s)]),a(" if any omissions.")])])])}const f=t(l,[["render",g],["__file","unity中调用安卓camera函数.html.vue"]]);export{f as default};
