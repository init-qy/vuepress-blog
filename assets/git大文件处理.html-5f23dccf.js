import{_ as o,r,o as t,c as i,a as e,b as a,d as n,e as l}from"./app-76d126c1.js";const c={},p=l(`<h2 id="background" tabindex="-1"><a class="header-anchor" href="#background" aria-hidden="true">#</a> Background</h2><p>Recientemente he estado desarrollando un proyecto de aplicación móvil con <code>flutter+unity</code>. Como es la primera vez que desarrollo con <code>unity</code>, no estoy muy familiarizado con la estructura de archivos de <code>unity</code>. Muchos archivos de modelos 3D de prueba en los activos (Assets) también se han incluido en el repositorio de <code>git</code>, lo que ha llevado a que el repositorio de <code>git</code> sea muy grande.</p><p>En realidad, este tipo de gestión de activos se manejaría mejor con <code>svn</code>, ya que incluye una gran cantidad de imágenes, archivos de audio y binarios. Sin embargo, el proyecto actual es pequeño y la gestión con <code>git</code> está bien.</p><h2 id="pasos" tabindex="-1"><a class="header-anchor" href="#pasos" aria-hidden="true">#</a> Pasos</h2><ol><li><p>Verificar el tamaño del repositorio de git</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> count-objects <span class="token parameter variable">-vH</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>Verificar los archivos grandes</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> rev-list <span class="token parameter variable">--objects</span> <span class="token parameter variable">--all</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> verify-pack <span class="token parameter variable">-v</span> .git/objects/pack/*.idx <span class="token operator">|</span> <span class="token function">sort</span> <span class="token parameter variable">-k</span> <span class="token number">3</span> <span class="token parameter variable">-n</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-10</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print$1}&#39;</span><span class="token variable">)</span></span>&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>Eliminar el archivo de todo el historial de ramas de git</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> filter-branch <span class="token parameter variable">--force</span> --index-filter <span class="token string">&#39;git rm -rf --cached --ignore-unmatch &lt;bigfile&gt;&#39;</span> --prune-empty --tag-name-filter <span class="token function">cat</span> -- <span class="token parameter variable">--all</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>Liberar espacio local</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> <span class="token parameter variable">-rf</span> .git/refs/original/
<span class="token function">git</span> reflog expire <span class="token parameter variable">--expire</span><span class="token operator">=</span>now <span class="token parameter variable">--all</span>
<span class="token function">git</span> gc <span class="token parameter variable">--prune</span><span class="token operator">=</span>now
<span class="token function">git</span> gc <span class="token parameter variable">--aggressive</span> <span class="token parameter variable">--prune</span><span class="token operator">=</span>now
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Hacer push al repositorio remoto</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">git</span> push origin <span class="token parameter variable">--force</span> <span class="token parameter variable">--all</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h2 id="otros" tabindex="-1"><a class="header-anchor" href="#otros" aria-hidden="true">#</a> Otros</h2><p>Después de completar los pasos anteriores y hacer push al repositorio remoto, a veces se puede observar que el repositorio de git remoto no solo no se ha reducido, sino que incluso ha aumentado de tamaño. Esto se debe a que el repositorio de git remoto no ha sido sometido a un proceso de gc.</p>`,7),d=e("code",null,"GitLab",-1),u={href:"https://docs.gitlab.com/ee/administration/housekeeping.html#running-housekeeping-tasks",target:"_blank",rel:"noopener noreferrer"},m=e("code",null,"Housekeeping",-1),h={href:"https://juejin.cn/post/7024922528514572302",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/linyuxuanlin/Wiki_MkDocs/issues/new",target:"_blank",rel:"noopener noreferrer"},v=e("strong",null,"feedback",-1);function g(k,f){const s=r("ExternalLinkIcon");return t(),i("div",null,[p,e("p",null,[a("Estoy utilizando "),d,a(" interno de la empresa como ejemplo, pero se puede utilizar la funcionalidad de "),e("a",u,[m,n(s)]),a(" de GitLab para solucionar este problema.")]),e("p",null,[a("Para obtener más detalles, puedes consultar "),e("a",h,[a("este artículo"),n(s)]),a(".")]),e("blockquote",null,[e("p",null,[a("Este post está traducido usando ChatGPT, por favor "),e("a",b,[v,n(s)]),a(" si hay alguna omisión.")])])])}const x=o(c,[["render",g],["__file","git大文件处理.html.vue"]]);export{x as default};
